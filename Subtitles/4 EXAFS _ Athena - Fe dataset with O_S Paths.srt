1
00:00:03,350 --> 00:00:05,250
大家好，我是 Shelly Kelly

2
00:00:05,250 --> 00:00:09,825
由我来介绍如何处理 EXAFS 数据

3
00:00:10,150 --> 00:00:12,150
样品是在铁的 K 边测量

4
00:00:13,775 --> 00:00:18,250
（目的）是来判定邻近原子是氧还是硫

5
00:00:18,984 --> 00:00:22,300
第一步打开 Athena

6
00:00:28,136 --> 00:00:31,650
所有的软件图标都在这个文件夹中

7
00:00:32,653 --> 00:00:36,500
首先打开 Athena 软件

8
00:00:59,150 --> 00:01:00,975
加载好了

9
00:01:00,975 --> 00:01:05,500
到文件 (File) 下方加载数据

10
00:01:06,650 --> 00:01:12,050
找到文件所在位置，点击加载

11
00:01:12,965 --> 00:01:16,325
选择我们需要处理的数据

12
00:01:16,325 --> 00:01:18,925
位于窗口左边的谱图数据

13
00:01:18,925 --> 00:01:20,925
加载所选数据

14
00:01:21,375 --> 00:01:24,075
参数会自动出现

15
00:01:24,075 --> 00:01:31,125
大致展现出数据在各个空间中 (E, k, R, q) 长什么样子

16
00:01:32,006 --> 00:01:35,775
把软件窗口挪一下

17
00:01:36,422 --> 00:01:41,200
我们来看下控制窗口的组成部分

18
00:01:41,525 --> 00:01:44,350
软件上方有多个功能菜单

19
00:01:44,919 --> 00:01:49,100
在它的下方是文件名

20
00:01:49,100 --> 00:01:51,100
以及保存 (save) 按钮

21
00:01:51,100 --> 00:01:53,750
以及这里我们是处在主窗口 (Main window) 界面 

22
00:01:53,750 --> 00:01:59,150
还有其他的功能窗口提供不同形式的数据处理

23
00:02:00,075 --> 00:02:04,525
在右手边是谱图数据

24
00:02:04,525 --> 00:02:11,350
如果有多组数据则会依次向下展示

25
00:02:12,650 --> 00:02:15,150
下一个

26
00:02:15,450 --> 00:02:19,750
告诉你的是 .prj 文件的保存路径

27
00:02:19,756 --> 00:02:25,200
元素，吸收边，能量移动（如果能量值曾被移动过）

28
00:02:25,200 --> 00:02:30,025
归一化，背景等参数在这里

29
00:02:30,025 --> 00:02:35,050
跟着是傅里叶变换和反傅里叶变换参数

30
00:02:35,050 --> 00:02:37,050
以及作图参数

31
00:02:37,375 --> 00:02:42,550
这里的黄色和紫色按键是用于如何处理数据

32
00:02:42,893 --> 00:02:46,750
上面黄色按键用于单个数据

33
00:02:46,750 --> 00:02:53,350
下面的紫色按键用于方框勾选中的多个数据

34
00:02:53,790 --> 00:03:00,375
比如我们点击黄色 E 键可以在能量范围内展示数据

35
00:03:00,375 --> 00:03:03,200
会出现数据和以能量为 x 轴展示的谱图

36
00:03:03,960 --> 00:03:06,610
如果想看归一化后的话

37
00:03:06,610 --> 00:03:11,325
就在下方勾选上归一化 (normalized) 

38
00:03:11,625 --> 00:03:13,800
展示的是归一化后的谱图

39
00:03:13,800 --> 00:03:16,492
边前的 y 轴大约为 0 

40
00:03:16,492 --> 00:03:19,450
吸收边以后的数据趋近于 1

41
00:03:19,725 --> 00:03:25,100
边前和边后的选择是依赖这部分参数

42
00:03:25,400 --> 00:03:32,625
E0 是用于转化数据到 k 空间时计算 k = 0 的参数

43
00:03:32,953 --> 00:03:35,100
用小黄点在图上标出

44
00:03:35,525 --> 00:03:39,175
 边前范围设置在这里

45
00:03:39,175 --> 00:03:42,125
数值是跟吸收边能量的相对数值

46
00:03:42,125 --> 00:03:45,550
从 -144.19 到 -30 eV 

47
00:03:46,257 --> 00:03:50,925
如果想看边前的曲线，勾选 pre-edge line

48
00:03:50,989 --> 00:03:55,400
出现边前曲线，以及左边选择的两个参数点

49
00:03:55,400 --> 00:04:00,175
可以看到边前曲线跟实验数据吻合很好

50
00:04:00,479 --> 00:04:03,100
如果想放大谱图

51
00:04:03,871 --> 00:04:08,675
可以改变 Emin 和 Emax 数值

52
00:04:09,685 --> 00:04:15,625
图放大后更清楚地看到实验室数据与边前曲线吻合

53
00:04:17,234 --> 00:04:26,475
边后曲线则是由这两个参数从 150 eV 到谱图的最后 858 eV

54
00:04:27,075 --> 00:04:29,075
勾选 post-edge line

55
00:04:29,800 --> 00:04:32,725
把谱图缩放回之前的范围

56
00:04:33,850 --> 00:04:35,850
从 -20

57
00:04:37,332 --> 00:04:38,075
到最后

58
00:04:38,075 --> 00:04:42,725
这个是第一个点

59
00:04:43,387 --> 00:04:46,575
还要把图范围拉长点

60
00:04:47,925 --> 00:04:49,925
第二点在这里

61
00:04:50,768 --> 00:04:58,375
可以通过改变归一化级数来改变边后曲线的曲率

62
00:04:58,375 --> 00:05:00,450
现在边后曲线有点弯

63
00:05:00,450 --> 00:05:02,750
 （应该看得出来）比较弯

64
00:05:02,750 --> 00:05:07,750
如果想把边后曲线变成直线，选择级数为 2

65
00:05:08,461 --> 00:05:10,925
现在紫线被迫调成直线

66
00:05:10,925 --> 00:05:12,840
（背景曲线先关掉）

67
00:05:12,840 --> 00:05:16,225
使得紫线变成直线

68
00:05:17,235 --> 00:05:20,650
（直线一样的边后）不适合这个数据

69
00:05:20,650 --> 00:05:28,025
你也可以选择级数为 1，边后曲线成了没有斜率的直线

70
00:05:28,753 --> 00:05:31,150
边后曲线完全不跟数据吻合

71
00:05:31,150 --> 00:05:32,787
是一个不恰当的选择

72
00:05:33,193 --> 00:05:35,200
当做出这些调整时

73
00:05:35,200 --> 00:05:38,052
能量跳高 (edge jump) 数值被重新计算

74
00:05:38,664 --> 00:05:41,850
跳高是通过...

75
00:05:45,437 --> 00:05:49,175
先把归一化级数改回到 2

76
00:05:49,529 --> 00:05:57,300
（跳高）是通过计算在吸收边 E0 的位置，边后曲线和边前之间的差距

77
00:05:57,650 --> 00:06:01,300
现在跳高数值为 0.366

78
00:06:01,300 --> 00:06:03,300
如果边后曲线稍弯一点

79
00:06:03,975 --> 00:06:06,975
边后曲线

80
00:06:07,230 --> 00:06:11,050
重新计算后的跳高有 0.41 

81
00:06:11,500 --> 00:06:20,875
这就是紫线（边后曲线）在改变级数之后的区别

82
00:06:21,350 --> 00:06:24,675
它是如何影响数据的呢

83
00:06:24,923 --> 00:06:27,675
先复制一份数据

84
00:06:28,975 --> 00:06:31,506
现在有两份数据并都勾选上

85
00:06:32,162 --> 00:06:36,300
把第二个数据的归一化级数改为 2

86
00:06:36,650 --> 00:06:40,375
重新计算跳高为 0.36

87
00:06:40,953 --> 00:06:45,750
第一个数据的级数是 3

88
00:06:45,750 --> 00:06:47,750
跳高为 0.41

89
00:06:48,200 --> 00:06:51,700
在 k 空间中对比两个数据

90
00:06:52,650 --> 00:07:05,175
可以看到跳高为 0.36 的在 k 空间振幅大于跳高 0.41 的数据

91
00:07:05,175 --> 00:07:09,625
这是因为归一化是将数据除以跳高

92
00:07:09,625 --> 00:07:18,250
在 E 空间中，归一化的数据从 0 到 1

93
00:07:18,250 --> 00:07:25,950
而不是 μ(E) 数据从 -0.95 到 -0.55

94
00:07:26,326 --> 00:07:32,750
归一化的数据是用于转换到 chi(k) 图像

95
00:07:32,885 --> 00:07:37,725
也会对 k 空间数据造成影响

96
00:07:38,965 --> 00:07:42,650
我好像一不小心把归一化级数调成 3 了

97
00:07:42,650 --> 00:07:43,625
好了

98
00:07:43,950 --> 00:07:59,825
如果在 R 空间中对比，也会看到由于振幅不同带来的区别

99
00:07:59,825 --> 00:08:07,300
这个跟决定配位数的强度成正比

100
00:08:07,300 --> 00:08:13,425
所以需要确保选择合适的边前和边后参数

101
00:08:13,431 --> 00:08:19,350
否则这个错误会影响你后续的配位数拟合

102
00:08:19,639 --> 00:08:23,225
通常这个误差可达 10%

103
00:08:23,225 --> 00:08:29,200
如果仔细检查数据，误差不会这么大

104
00:08:31,370 --> 00:08:35,250
选择归一化级数为 3

105
00:08:35,414 --> 00:08:41,475
跳高为 0.41， R 空间中信号强度更低

106
00:08:43,414 --> 00:08:48,550
另外一个常见问题

107
00:08:49,125 --> 00:08:59,964
如何为傅里叶变换后的数据决定 Rbkg 值

108
00:09:00,464 --> 00:09:03,100
Rbkg 在这里

109
00:09:03,100 --> 00:09:11,350
决定了背景曲线的震荡程度

110
00:09:11,350 --> 00:09:13,250
也就是能有多大程度与实验数据贴合

111
00:09:13,250 --> 00:09:18,975
可以看到数据由若干正弦函数组成

112
00:09:18,975 --> 00:09:23,481
我们不希望背景曲线的震荡频率跟真实信号一样

113
00:09:23,481 --> 00:09:27,250
 否则可能会导致真实数据变得更强或是更弱

114
00:09:27,250 --> 00:09:29,900
但是也需要一点曲率

115
00:09:29,900 --> 00:09:38,100
背景曲线顺着吸收边以后的线条曲率

116
00:09:38,725 --> 00:09:42,375
我们来看下

117
00:09:42,496 --> 00:09:46,825
先把这两组数据的参数设置成一样

118
00:09:46,825 --> 00:09:48,825
鼠标右键点击抬头

119
00:09:48,888 --> 00:09:52,175
选择“所有数据使用相同参数”

120
00:09:52,175 --> 00:09:54,175
这样数据就一样了

121
00:09:54,913 --> 00:09:57,650
在能量范围内展示数据

122
00:09:58,325 --> 00:10:01,825
取消展示边后曲线和归一化数据

123
00:10:01,825 --> 00:10:03,325
展示背景曲线

124
00:10:03,325 --> 00:10:05,325
背景曲线长这样

125
00:10:05,502 --> 00:10:11,775
把 Rbkg 改成 1.2

126
00:10:12,100 --> 00:10:15,025
再看下背景曲线

127
00:10:15,025 --> 00:10:20,775
可以看到跟之前相比，这里有点曲率变大

128
00:10:21,125 --> 00:10:23,967
如果把 Rbkg 改到 1.5

129
00:10:23,967 --> 00:10:25,967
在 E 空间中作图

130
00:10:26,230 --> 00:10:29,825
可以看到背景曲率更多了

131
00:10:30,950 --> 00:10:37,175
我们可以复制成三份数据然后放在一起比较

132
00:10:40,575 --> 00:10:45,300
复制当前数据，现在三份一样的数据了

133
00:10:45,625 --> 00:10:48,675
设置第一个数据的 Rbkg 为 1

134
00:10:48,793 --> 00:10:51,400
第二个是 1.2

135
00:10:51,673 --> 00:10:54,875
第三个是 1.5

136
00:10:55,062 --> 00:10:59,375
在 k 空间中展示

137
00:10:59,375 --> 00:11:07,000
可以看到前两个数据谱图 (Rbkg = 1 和 1.2) 非常接近

138
00:11:07,000 --> 00:11:12,025
在 k 值低区域的背景函数是定义的最不明确的

139
00:11:12,625 --> 00:11:15,350
所以看到的改变最大

140
00:11:15,350 --> 00:11:24,175
当背景曲线允许更多弹性，会看到在这个区间的震荡更多

141
00:11:24,280 --> 00:11:26,975
对于一开始处理数据

142
00:11:26,975 --> 00:11:29,500
做这样的比较是好的

143
00:11:29,500 --> 00:11:34,775
设置傅里叶变换的起始点设置在数据不受 Rbkg 值影响的地方

144
00:11:34,775 --> 00:11:41,600
因为真实的数据是不受背景方程影响

145
00:11:41,600 --> 00:11:47,600
如果选择 3 作为 kmin

146
00:11:47,708 --> 00:11:53,950
可以看到在 3 以后的图像是一样的

147
00:11:54,044 --> 00:11:56,044
(kmin) 默认值为 3

148
00:11:56,044 --> 00:11:59,650
现在 kmax 值是 10

149
00:11:59,788 --> 00:12:03,650
如果在 R 空间中

150
00:12:03,975 --> 00:12:08,550
三个数据基本上一样

151
00:12:08,550 --> 00:12:21,400
你也可以点击 kq 键来观察指定 R 空间内数据在 k 空间中与原始数据的对比

152
00:12:21,432 --> 00:12:26,550
现在可以看到窗函数对数据的影响

153
00:12:26,550 --> 00:12:30,300
信号在一开始衰减

154
00:12:30,300 --> 00:12:33,775
由于在傅里叶变换中的窗函数 （是从 3 开始的）

155
00:12:33,775 --> 00:12:35,775
在 k = 10 以上也是相似的

156
00:12:35,775 --> 00:12:42,600
但是这个地方大部分是噪音

157
00:12:42,600 --> 00:12:49,600
来看下背景函数（误）， 是窗函数

158
00:12:49,600 --> 00:12:50,950
这是窗函数

159
00:12:50,950 --> 00:12:57,050
在这两个点之间的数据没有衰减

160
00:12:57,125 --> 00:13:01,625
这部分的数据由于窗函数而存在衰减

161
00:13:01,989 --> 00:13:06,700
窗函数的截断参数由 dk 来决定

162
00:13:06,700 --> 00:13:09,825
如果把 dk 从 1 改到 2

163
00:13:09,825 --> 00:13:16,075
（ kq 误）点击 k 键，展示窗函数

164
00:13:16,075 --> 00:13:18,525
可以看到衰减区域变长

165
00:13:19,450 --> 00:13:23,600
从 k = 2 到 4

166
00:13:23,899 --> 00:13:27,200
中心在 3，也就是 kmin 值

167
00:13:27,650 --> 00:13:30,427
点击 kq

168
00:13:32,200 --> 00:13:39,225
可以看到现在的数据在这个区间相比之前有一点衰减

169
00:13:39,748 --> 00:13:43,450
现在反傅里叶变换区间是在 1 到 3 

170
00:13:43,450 --> 00:13:48,900
去到 R 空间，在 1 到 3

171
00:13:48,900 --> 00:13:51,850
忽略掉了这部分信号

172
00:13:52,100 --> 00:13:56,225
如果反傅里叶变换区间变成 1 到 6

173
00:13:57,725 --> 00:14:00,250
比如

174
00:14:00,250 --> 00:14:07,975
可以看到这些拍频在反傅里叶变换中出现

175
00:14:08,189 --> 00:14:15,725
你也可以只对 R 值高的部分信号做反傅里叶变换

176
00:14:16,275 --> 00:14:20,100
设置对 R = 3 到 6 之间做反傅里叶变换

177
00:14:20,100 --> 00:14:22,100
点击 kq

178
00:14:22,100 --> 00:14:27,075
可以看到这部分 R 空间的信号在 k 空间中是什么样子

179
00:14:27,123 --> 00:14:29,975
信号遍布整个 k 空间

180
00:14:29,975 --> 00:14:33,975
从 k = 0 开始，一直到 k 值高的区域

181
00:14:33,975 --> 00:14:37,275
它们对 k 空间的相依性不同 

182
00:14:38,800 --> 00:14:46,375
氧和硫在 k 值低的区域信号更强，到 k 值高区域衰减

183
00:14:46,564 --> 00:14:51,600
一些比较重的原子则是有相反的规律，比如铁

184
00:14:51,600 --> 00:14:56,400
在 k 值高的区域信号更强

185
00:14:58,725 --> 00:15:02,975
这就是关于傅里叶和反傅里叶变换的介绍了

186
00:15:02,975 --> 00:15:11,949
傅里叶变换从 k = 3 到 10 

187
00:15:12,217 --> 00:15:17,250
可以对参数进行改变

188
00:15:17,250 --> 00:15:22,600
把三个数据都设置成跟第一个一样的傅里叶变换参数

189
00:15:22,600 --> 00:15:25,255
所有的背景函数参数一样

190
00:15:25,639 --> 00:15:28,875
所有傅里叶变换参数一样

191
00:15:29,223 --> 00:15:33,650
现在来对比 kmax 数值带来的影响

192
00:15:33,650 --> 00:15:40,075
把各自的 kmax 分别设置成 10, 12 和 14

193
00:15:40,650 --> 00:15:42,650
点击 k 键

194
00:15:43,153 --> 00:15:45,725
傅里叶变换包含了这部分信号

195
00:15:45,755 --> 00:15:49,400
猜测也许这里存在有用的信号，也有可能没有

196
00:15:49,400 --> 00:15:51,400
现在来测试下

197
00:15:52,750 --> 00:15:55,250
来做傅里叶变换

198
00:15:55,250 --> 00:15:57,250
点击 R 键

199
00:15:57,462 --> 00:16:03,025
看到谱图有一点区别

200
00:16:03,025 --> 00:16:05,025
尤其是在这部分

201
00:16:05,025 --> 00:16:09,775
在信号低的地方能更清楚地看到区别

202
00:16:09,865 --> 00:16:13,975
我更喜欢在实部空间观察数据

203
00:16:13,975 --> 00:16:17,250
把 R 空间展示范围扩展到 10 Å

204
00:16:17,250 --> 00:16:20,475
这是傅里叶变换计算的上限

205
00:16:20,969 --> 00:16:25,125
可以清晰看到绿线有更多的噪音

206
00:16:25,125 --> 00:16:31,150
绿线看起来只是无规则，没有特征地震动

207
00:16:31,150 --> 00:16:34,925
说明在 k 空间选中的数据太长

208
00:16:34,925 --> 00:16:40,225
你也许不应该扩展到 k = 14

209
00:16:40,675 --> 00:16:45,000
在我看来 k = 12 以内的数据比较干净

210
00:16:45,000 --> 00:16:47,250
那就先只比较这两个

211
00:16:47,250 --> 00:16:49,250
可以看到有一点波动

212
00:16:49,575 --> 00:16:53,550
但是第一层信号看着非常干净

213
00:16:54,206 --> 00:16:58,425
在 q 空间中对比两个数据

214
00:16:58,425 --> 00:17:03,225
两者只在这里有一点点的区别

215
00:17:03,225 --> 00:17:08,250
这里有一个很小的信号差别，但是是很明确的信号

216
00:17:08,250 --> 00:17:13,850
你可以通过改变 k 的权重来强调这部分信号

217
00:17:13,940 --> 00:17:16,975
现在图像是 k 二次方权重

218
00:17:16,975 --> 00:17:19,300
改成 k 的三次方权重

219
00:17:19,300 --> 00:17:23,075
强调这部分信号，来对比差别

220
00:17:23,700 --> 00:17:29,400
可以跟原始数据一起比较

221
00:17:29,400 --> 00:17:32,750
观察哪一部分的原始数据被包含进去

222
00:17:32,750 --> 00:17:35,100
包含了这部分

223
00:17:35,375 --> 00:17:38,875
还行

224
00:17:38,875 --> 00:17:42,300
另一个选 kmax = 10 的到了这里

225
00:17:42,300 --> 00:17:44,425
信号在这里变小

226
00:17:45,580 --> 00:17:50,825
我们选择 k =3 到 12 作为傅里叶变换参数

227
00:17:50,825 --> 00:17:55,325
保存数据和文件

228
00:17:55,325 --> 00:17:58,450
到文件 (File)，保存项目

229
00:17:59,132 --> 00:18:01,132
保存到桌面

230
00:18:02,268 --> 00:18:06,025
重命名为 Fe_athena.prj

231
00:18:08,125 --> 00:18:10,125
保存

232
00:18:13,975 --> 00:18:18,400
下一步打开 Artemis

233
00:18:19,901 --> 00:18:25,825
回到之前的文件夹，找到 Artemis 图标，点击打开

234
00:18:31,700 --> 00:18:34,300
要点时间打开

235
00:18:51,875 --> 00:18:57,975
这里是文件，我得缩小下 Artemis 界面

236
00:19:03,500 --> 00:19:07,100
我来看看怎么弄

237
00:19:14,103 --> 00:19:17,750
先停下

