1
00:00:01,575 --> 00:00:04,125
大家好，我是 Shelly Kelly

2
00:00:04,125 --> 00:00:08,425
这节讲解如何模拟之前

3
00:00:08,425 --> 00:00:15,550
在 Athena 处理的铁样品在 K 边的数据

4
00:00:16,475 --> 00:00:19,450
第一步打开 Artemis

5
00:00:19,450 --> 00:00:26,050
这里是控制区域

6
00:00:26,850 --> 00:00:30,950
处理数据第一步

7
00:00:30,950 --> 00:00:34,525
把数据加载到 Artemis 中

8
00:00:34,850 --> 00:00:36,525
点击按钮

9
00:00:36,525 --> 00:00:39,500
找到 Athena 文件

10
00:00:39,500 --> 00:00:41,500
也就是打开这个

11
00:00:47,475 --> 00:00:50,725
你会看到一系列数据文件

12
00:00:50,725 --> 00:00:53,775
两份原始数据

13
00:00:53,775 --> 00:00:55,775
以及参考谱图

14
00:00:56,250 --> 00:00:58,700
这是合并之后的数据

15
00:00:58,700 --> 00:01:02,125
选择合并之后的数据

16
00:01:02,475 --> 00:01:07,225
Artemis 有像这样的预览窗口展示谱图

17
00:01:07,225 --> 00:01:09,225
傅里叶变换后强度的谱图（也就是 EXAFS R 空间数据）

18
00:01:09,900 --> 00:01:14,600
也可以选择其他形式的谱图

19
00:01:14,600 --> 00:01:17,600
如果你想看 μ(E) 图等等

20
00:01:17,600 --> 00:01:19,600
或者就是 R 空间数据

21
00:01:20,500 --> 00:01:27,025
我们需要让 Artemis 获得项目文件中的参数

22
00:01:27,257 --> 00:01:29,700
加载数据

23
00:01:30,225 --> 00:01:33,600
出现一个面板

24
00:01:33,600 --> 00:01:38,425
包含了你刚加载的数据

25
00:01:38,425 --> 00:01:40,425
在左手边这里

26
00:01:40,425 --> 00:01:44,750
说明是第五组 Athena 文件中的数据

27
00:01:44,750 --> 00:01:48,200
傅里叶变换参数保留了项目文件中的选择

28
00:01:48,200 --> 00:01:51,200
k 从 3 到 15.3

29
00:01:51,200 --> 00:01:54,750
待拟合的范围在 R 空间中的 1 到 3 Å

30
00:01:55,616 --> 00:02:02,975
下一步，加载 FEFF 计算

31
00:02:02,975 --> 00:02:05,025
点击 FEFF 下方的 "Add"进行加载

32
00:02:05,750 --> 00:02:09,491
我这里有硫化铁的晶体文件

33
00:02:09,491 --> 00:02:13,075
我要用这个文件就直接加载进去

34
00:02:13,075 --> 00:02:22,125
加载后会跳出来一个窗口

35
00:02:22,625 --> 00:02:25,600
有空间群，晶格常数

36
00:02:25,600 --> 00:02:29,725
在晶格单元中各原子坐标

37
00:02:30,050 --> 00:02:32,925
你必须要选择一个中心原子

38
00:02:32,925 --> 00:02:34,425
铁或是硫

39
00:02:34,425 --> 00:02:37,850
如果是硫的 K 边，则要勾选第二个

40
00:02:37,850 --> 00:02:41,925
但它猜到我们需要铁的计算

41
00:02:41,925 --> 00:02:43,925
我们也确实是

42
00:02:44,328 --> 00:02:47,450
看起来没有问题，点击 Run Atoms 

43
00:02:48,100 --> 00:02:52,450
这里首先是有一些参数

44
00:02:52,450 --> 00:02:54,800
中间是一些用于控制计算的参数

45
00:02:54,800 --> 00:02:58,825
通常来说需要留意 potential （势）

46
00:02:58,825 --> 00:03:00,825
尤其是 ipot 数值

47
00:03:00,825 --> 00:03:05,650
这代表了在列表中将要被计算的原子

48
00:03:06,930 --> 00:03:10,675
ipot = 0 的原子永远是中心原子

49
00:03:10,675 --> 00:03:12,850
也就是铁

50
00:03:12,850 --> 00:03:14,850
剩下的是邻近原子

51
00:03:14,850 --> 00:03:19,700
邻近原子的 ipot 数字跟中心原子的不一样

52
00:03:19,700 --> 00:03:21,700
比如硫原子（ipot = 2）

53
00:03:22,275 --> 00:03:24,250
 如果进一步观察

54
00:03:24,250 --> 00:03:28,700
邻近原子与铁之间的距离在这里（最右一列）

55
00:03:28,975 --> 00:03:35,750
可以看到这两个硫原子离铁原子近到不太现实

56
00:03:35,750 --> 00:03:37,750
永远先观察

57
00:03:38,550 --> 00:03:46,725
这说明晶体文件给出的计算结果不太对

58
00:03:47,175 --> 00:03:49,600
回到 Atoms 页面

59
00:03:50,275 --> 00:03:56,550
我常用的手段之一是向原始晶胞加上一个偏移

60
00:03:56,550 --> 00:03:58,550
就是这一部分（用来输入偏移参数）

61
00:03:58,550 --> 00:03:59,925
点击 insert 键

62
00:03:59,925 --> 00:04:01,925
再点击 Run Atoms 试一试

63
00:04:01,925 --> 00:04:03,300
如果这个方法不奏效

64
00:04:03,300 --> 00:04:07,775
我会用其他软件打开晶体文件

65
00:04:07,775 --> 00:04:11,425
查看下空间群及其他参数

66
00:04:11,425 --> 00:04:15,075
看一下哪里还可以改进的

67
00:04:15,350 --> 00:04:18,375
那就先这么试下，点击 Run Atoms

68
00:04:19,000 --> 00:04:21,875
看起来现在好了

69
00:04:21,875 --> 00:04:27,000
现在硫原子有了较为合理的距离（壳层）

70
00:04:27,000 --> 00:04:29,925
铁硫之间距离在 2.23 Å

71
00:04:30,875 --> 00:04:32,875
点击 Run Feff

72
00:04:34,725 --> 00:04:38,200
出现了一系列散射路径

73
00:04:38,200 --> 00:04:40,750
第一条（绿色字体）路径

74
00:04:40,750 --> 00:04:42,750
是单散射路径

75
00:04:42,750 --> 00:04:44,750
第一条路径的排名（rank）永远是 100

76
00:04:44,750 --> 00:04:47,950
剩下路径的排名都是根据第一条路径来计算的

77
00:04:48,606 --> 00:04:53,050
可以看到前面两条路径非常重要（rank值大）

78
00:04:53,100 --> 00:04:56,200
第二条是 Fe-Fe 路径

79
00:04:56,200 --> 00:04:59,025
距离 2.6 Å，简并度是 4

80
00:04:59,550 --> 00:05:06,975
这里名字是指从中心原子到硫原子

81
00:05:06,975 --> 00:05:08,975
然后再回到中心原子

82
00:05:08,975 --> 00:05:10,975
单散射路径

83
00:05:11,550 --> 00:05:13,550
简并度为 4

84
00:05:15,825 --> 00:05:17,900
那我们取头两个路径

85
00:05:17,900 --> 00:05:21,150
按住 Shift 键选择两条路径

86
00:05:21,150 --> 00:05:24,300
从路径列表拖到样品窗口

87
00:05:24,300 --> 00:05:25,825
这样就可以用了

88
00:05:26,500 --> 00:05:29,175
现在要设置 EXAFS 参数

89
00:05:29,675 --> 00:05:32,550
把简并度改为 1

90
00:05:33,475 --> 00:05:37,750
S02 设置为 amp 乘以 Ns

91
00:05:37,750 --> 00:05:40,083
（Ns）代表硫原子配位数

92
00:05:40,325 --> 00:05:42,800
ΔE 代表 E0 的偏移值

93
00:05:42,800 --> 00:05:44,950
drs

94
00:05:44,950 --> 00:05:48,975
sigma 平方绝对值

95
00:05:49,425 --> 00:05:54,450
对第二个路径做同样的操作

96
00:05:54,450 --> 00:05:59,450
把第一条路径的参数复制过去

97
00:05:59,450 --> 00:06:02,300
勾选第二条路径

98
00:06:02,300 --> 00:06:07,098
鼠标右击，输出 (export) 对应参数

99
00:06:07,738 --> 00:06:10,875
E0, ΔR, σ2 等等

100
00:06:10,875 --> 00:06:13,375
到第二条路径

101
00:06:13,978 --> 00:06:17,625
可以看到参数已经复制过来

102
00:06:17,625 --> 00:06:20,700
我只需要修改一下

103
00:06:20,700 --> 00:06:25,225
跟铁原子路径相关的参数

104
00:06:25,883 --> 00:06:29,450
那把参数放到猜测窗口

105
00:06:29,450 --> 00:06:32,175
这样拟合参数就能开始参与拟合

106
00:06:32,950 --> 00:06:34,975
这就是参数猜测窗口

107
00:06:34,975 --> 00:06:38,400
在amp上鼠标右击

108
00:06:38,775 --> 00:06:41,200
把它设置成 guess

109
00:06:41,200 --> 00:06:44,350
你也可以改成其他方式

110
00:06:44,725 --> 00:06:49,200
可以定义或设置或跳过这个参数

111
00:06:50,805 --> 00:06:53,800
通常我会从猜测这个参数开始

112
00:06:54,700 --> 00:06:59,175
我会按照每个壳层来列出参数

113
00:06:59,550 --> 00:07:04,625
点击并列举第二条路径的参数

114
00:07:05,675 --> 00:07:07,675
全体就绪

115
00:07:07,675 --> 00:07:11,500
把配位数 guess 4

116
00:07:11,500 --> 00:07:18,200
我会一开始都直接固定参数的数值

117
00:07:21,100 --> 00:07:22,800
先进行一次拟合

118
00:07:22,800 --> 00:07:24,650
还要做的事情

119
00:07:24,650 --> 00:07:28,400
观察这两条路径各自的贡献

120
00:07:28,650 --> 00:07:32,925
勾选 Plot after fit 就可以看到了

121
00:07:33,350 --> 00:07:39,000
路径会被自动加入到画图窗口

122
00:07:39,575 --> 00:07:41,975
点击 fit 按键

123
00:07:41,975 --> 00:07:45,225
虽然我们只是单纯地把两个路径加在一起

124
00:07:45,550 --> 00:07:50,000
可以看到傅里叶变换后的强度和实部空间

125
00:07:50,000 --> 00:07:53,250
蓝线是实验数据，红线是拟合数据

126
00:07:53,250 --> 00:07:58,850
在没有改动任何任何参数的情况下看起来还挺好的

127
00:07:59,475 --> 00:08:00,900
我们……

128
00:08:00,900 --> 00:08:04,600
出于不知名原因，原始数据不在画图窗口中

129
00:08:04,600 --> 00:08:06,600
回到数据窗口

130
00:08:06,600 --> 00:08:10,000
勾选 plot after fit

131
00:08:10,000 --> 00:08:15,100
也可以直接点击蓝色按钮加入实验数据

132
00:08:15,100 --> 00:08:17,500
把数据放在第一个

133
00:08:17,500 --> 00:08:19,500
这样便于观察

134
00:08:24,175 --> 00:08:26,175
回到图像窗口

135
00:08:26,925 --> 00:08:30,850
展示各自路径的贡献

136
00:08:31,750 --> 00:08:37,775
可以看到傅里叶变换实部数据看起来不错

137
00:08:38,100 --> 00:08:41,000
这是第一壳层的硫原子

138
00:08:41,000 --> 00:08:46,425
这个是铁的壳层

139
00:08:46,425 --> 00:08:48,425
这个强度需要降低一些

140
00:08:48,425 --> 00:08:50,775
目前看起来太强了

141
00:08:51,200 --> 00:08:53,825
但总的来说很吻合

142
00:08:53,825 --> 00:09:00,475
实验数据中的特征可以被模型中的路径所代表

143
00:09:01,125 --> 00:09:03,950
还可以去到 k 空间

144
00:09:04,625 --> 00:09:10,875
可以看到在 k 值低的区域数据吻合

145
00:09:11,200 --> 00:09:14,250
是氧原子信号主要集中的地方

146
00:09:14,625 --> 00:09:18,675
在 k 值高的区域是两条路径的结合

147
00:09:19,000 --> 00:09:22,050
但数据看起来有点偏移

148
00:09:22,050 --> 00:09:26,025
这主要是因为铁的路径需要调整一下

149
00:09:26,350 --> 00:09:30,000
我认为一开始的猜测是合理的

150
00:09:30,000 --> 00:09:32,825
可以帮助我们找到最后的最小值

151
00:09:32,825 --> 00:09:36,629
开始变动一些参数

152
00:09:37,973 --> 00:09:41,700
我把 amp 设为 0.8

153
00:09:41,700 --> 00:09:44,900
对铁而言是个合理的数值

154
00:09:44,900 --> 00:09:51,450
这个数值通常可以通过拟合已知配位数铁片数据得到

155
00:09:52,300 --> 00:09:56,775
如果知道配位数，就可以设置 amp 为变量

156
00:09:56,775 --> 00:09:58,775
从而得到 amp 值

157
00:09:58,775 --> 00:10:02,225
跑一次拟合

158
00:10:04,650 --> 00:10:07,150
拟合结果很好

159
00:10:08,125 --> 00:10:11,425
来检查下最优参数组合

160
00:10:11,875 --> 00:10:17,600
看起来能量偏移值为 3 ± 0.5 eV 

161
00:10:17,600 --> 00:10:18,875
很好

162
00:10:19,350 --> 00:10:23,250
配位数变量返回 4 ± 0.2

163
00:10:23,250 --> 00:10:28,125
ΔR 对硫路径很小，只有 0.04 Å

164
00:10:28,575 --> 00:10:31,900
sigma平方是 0.003

165
00:10:32,150 --> 00:10:35,800
对于硫第一壳层而言是个正常值

166
00:10:36,900 --> 00:10:40,950
第二壳层看起来只有两个铁原子而不是四个

167
00:10:40,950 --> 00:10:44,725
之前看到配位数为 4 的时候信号太强

168
00:10:44,725 --> 00:10:46,725
所以拟合过程中配位数降低了

169
00:10:47,625 --> 00:10:52,175
ΔR 是 0.1 Å，说明比参考距离要长了 0.1 Å

170
00:10:52,575 --> 00:10:57,550
sigma平方数值为 0.003

171
00:10:57,594 --> 00:10:59,594
对第二壳层来说有点小

172
00:10:59,594 --> 00:11:01,594
但也不是没可能

173
00:11:02,400 --> 00:11:05,925
使用最佳拟合结果数值

174
00:11:06,650 --> 00:11:08,900
这样拟合的起点就是最佳拟合数值组合了

175
00:11:08,900 --> 00:11:13,925
你只需要点击 use best fit 就够了

176
00:11:14,900 --> 00:11:18,750
这就是初始猜测的数值

177
00:11:19,375 --> 00:11:23,600
来看下不同空间中的拟合图像

178
00:11:23,600 --> 00:11:27,000
在傅里叶变换的实部

179
00:11:27,425 --> 00:11:32,550
可以分别看到硫和铁的贡献

180
00:11:33,225 --> 00:11:38,950
也可以加上窗函数

181
00:11:38,950 --> 00:11:40,950
看下数据是否合理

182
00:11:42,525 --> 00:11:47,575
从 1 开始的话有错过一点点数据

183
00:11:47,575 --> 00:11:50,425
3 也有点太高了

184
00:11:50,731 --> 00:11:54,827
我想缩小一点范围

185
00:11:55,211 --> 00:11:58,525
把 1 改成 1.2

186
00:12:00,250 --> 00:12:04,125
1.2 大致在这里

187
00:12:04,125 --> 00:12:07,650
大概这里是 2.7

188
00:12:08,665 --> 00:12:10,665
rmax 改成 2.7

189
00:12:10,854 --> 00:12:15,550
到 k 和 q 空间去 

190
00:12:15,550 --> 00:12:18,292
列出各自路径贡献

191
00:12:18,676 --> 00:12:22,100
扩展下范围

192
00:12:22,348 --> 00:12:24,075
好了

193
00:12:24,075 --> 00:12:28,650
看起来拟合结果很好

194
00:12:29,075 --> 00:12:32,875
低于 3 的部分结果不太吻合

195
00:12:32,875 --> 00:12:36,525
所以 k 的下限不能再往下走了

196
00:12:36,900 --> 00:12:42,300
k = 15 上限已经很接近数据的终点了

197
00:12:42,575 --> 00:12:45,150
还可以看反傅里叶变换

198
00:12:45,150 --> 00:12:48,675
代表着被拟合区间的数据

199
00:12:48,675 --> 00:12:52,650
我们移除了高频信号

200
00:12:53,171 --> 00:12:57,225
基本上没有太多可以改动的

201
00:12:57,225 --> 00:12:59,800
把 q 空间再往上看下

202
00:13:00,575 --> 00:13:04,850
看起来数据已经被尽可能利用了

203
00:13:07,003 --> 00:13:09,850
看起来挺好的

204
00:13:10,518 --> 00:13:13,175
再跑一次拟合

205
00:13:13,175 --> 00:13:16,675
鉴于我们缩小了范围

206
00:13:17,519 --> 00:13:21,300
看下是否能降低不确定值

207
00:13:21,300 --> 00:13:23,300
改动不大

208
00:13:23,725 --> 00:13:26,525
这里还是 0.2

209
00:13:26,950 --> 00:13:32,900
我们可以去历史窗口来比较两次拟合

210
00:13:33,625 --> 00:13:36,175
这是上一次的拟合

211
00:13:36,175 --> 00:13:38,175
范围较宽的那一组

212
00:13:38,175 --> 00:13:40,875
于是有了 15 个独立数据点，7 个变量

213
00:13:41,528 --> 00:13:44,400
reduced chi-square 接近 2000

214
00:13:44,844 --> 00:13:48,075
第二组有 11 个独立数据点

215
00:13:48,075 --> 00:13:50,075
7 个独立变量

216
00:13:50,075 --> 00:13:52,075
reduced chi-square  高了一些

217
00:13:52,475 --> 00:13:56,225
所以缩小范围并没有改善拟合

218
00:13:56,225 --> 00:14:02,825
对里面的噪音一类的都没有改进

219
00:14:05,350 --> 00:14:09,375
在报告的后半部分有参数

220
00:14:10,107 --> 00:14:22,450
如果你在拟合的界面有比较复杂的数学关系式

221
00:14:22,450 --> 00:14:24,450
展示在这里

222
00:14:24,450 --> 00:14:26,450
你可以用上数学表达式

223
00:14:26,450 --> 00:14:29,050
有时候会报错

224
00:14:29,050 --> 00:14:35,300
如果要解决问题就要回到这里来看怎么一回事

225
00:14:35,300 --> 00:14:39,925
对应的数值会展示在这里

226
00:14:39,925 --> 00:14:41,925
E0 会在这里

227
00:14:41,925 --> 00:14:44,525
Reff 指的是参考距离

228
00:14:44,525 --> 00:14:50,400
R 是最终经过 ΔR 调整后路径距离

229
00:14:50,400 --> 00:14:53,409
看起来挺好的

230
00:14:56,300 --> 00:15:10,475
这代表着拟合数据告诉我们第一层硫和第二层铁的信息

231
00:15:11,300 --> 00:15:13,300
感谢你的观看

